{
	"title":"安装证书",
	"updateTime":"2018-04-26 17:35:16",
	"content":"安装证书\r\n\r\nTomcat支持JKS格式证书，从Tomcat7开始也支持PFX格式证书，两种证书格式任选其一。\r\n\r\n文件说明：\r\n\r\n1. 证书文件214032549710438.pem，包含两段内容，请不要删除任何一段内容。\r\n\r\n2. 如果是证书系统创建的CSR，还包含：证书私钥文件214032549710438.key、PFX格式证书文件214032549710438.pfx、PFX格式证书密码文件pfx-password.txt。\r\n\r\n1、证书格式转换\r\n\r\n在Tomcat的安装目录下创建cert目录，并且将下载的全部文件拷贝到cert目录中。如果申请证书时是自己创建的CSR文件，附件中只包含214032549710438.pem文件，还需要将私钥文件拷贝到cert目录，命名为214032549710438.key；如果是系统创建的CSR，请直接到第2步。\r\n\r\n到cert目录下执行如下命令完成PFX格式转换命令，此处要设置PFX证书密码，请牢记：\r\n\r\nopenssl pkcs12 -export -out 214032549710438.pfx -inkey 214032549710438.key -in 214032549710438.pem\r\n2、PFX证书安装\r\n\r\n找到安装Tomcat目录下该文件server.xml,一般默认路径都是在 conf 文件夹中。找到 \u003cConnection port\u003d\"8443\" 标签，增加如下属性：\r\n\r\nkeystoreFile\u003d\"cert/214032549710438.pfx\"\r\nkeystoreType\u003d\"PKCS12\"\r\n#此处的证书密码，请参考附件中的密码文件或在第1步中设置的密码\r\nkeystorePass\u003d\"证书密码\"\r\n完整的配置如下，其中port属性根据实际情况修改：\r\n\r\n\u003cConnector port\u003d\"8443\"\r\n    protocol\u003d\"HTTP/1.1\"\r\n    SSLEnabled\u003d\"true\"\r\n    scheme\u003d\"https\"\r\n    secure\u003d\"true\"\r\n    keystoreFile\u003d\"cert/214032549710438.pfx\"\r\n    keystoreType\u003d\"PKCS12\"\r\n    keystorePass\u003d\"证书密码\"\r\n    clientAuth\u003d\"false\"\r\n    SSLProtocol\u003d\"TLSv1+TLSv1.1+TLSv1.2\"\r\n    ciphers\u003d\"TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256,TLS_RSA_WITH_AES_128_CBC_SHA256,TLS_RSA_WITH_AES_256_CBC_SHA256\"/\u003e\r\n3、JKS证书安装(帮助)\r\n\r\n( 1 ) 使用java jdk将PFX格式证书转换为JKS格式证书(windows环境注意在%JAVA_HOME%/jdk/bin目录下执行)\r\n\r\nkeytool -importkeystore -srckeystore 214032549710438.pfx -destkeystore your-name.jks -srcstoretype PKCS12 -deststoretype JKS\r\n回车后输入JKS证书密码和PFX证书密码，强烈推荐将JKS密码与PFX证书密码相同，否则可能会导致Tomcat启动失败。\r\n\r\n( 2 ) 找到安装 Tomcat 目录下该文件Server.xml，一般默认路径都是在 conf 文件夹中。找到 \u003cConnection port\u003d\"8443\" 标签，增加如下属性：\r\n\r\nkeystoreFile\u003d\"cert/your-name.jks\"\r\nkeystorePass\u003d\"证书密码\"\r\n完整的配置如下，其中port属性根据实际情况修改：\r\n\r\n\u003cConnector port\u003d\"8443\"\r\n    protocol\u003d\"HTTP/1.1\"\r\n    SSLEnabled\u003d\"true\"\r\n    scheme\u003d\"https\"\r\n    secure\u003d\"true\"\r\n    keystoreFile\u003d\"cert/your-name.jks\"\r\n    keystorePass\u003d\"证书密码\"\r\n    clientAuth\u003d\"false\"\r\n    SSLProtocol\u003d\"TLSv1+TLSv1.1+TLSv1.2\"\r\n    ciphers\u003d\"TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256,TLS_RSA_WITH_AES_128_CBC_SHA256,TLS_RSA_WITH_AES_256_CBC_SHA256\"/\u003e\r\n( 注意:不要直接拷贝所有配置，只需添加 keystoreFile,keystorePass等参数即可，其它参数请根据自己的实际情况修改 )\r\n\r\n4、 重启 Tomcat。\r\n\r\n5、 通过 https 方式访问您的站点，测试站点证书的安装配置，如遇到证书不信任问题，请查看帮助视频。",
	"sort":2
}